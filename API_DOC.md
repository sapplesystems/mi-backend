# API Documentation

## Register a product items

**Endpoint:** /api/v1/products/<application_id>/

This endpoint registers product items for given application-id. Once you make a request for a product items, server stores it and generates unique URL to be used in QR code. Format of the URL is pre-defined, e.g. `https://<domain>/product-details/<application_id>/<sequence_id>`

This endpoint returns the below response:

- `201`: Indicates server has created your product item.
- `400`:  Indicates bad request if request contains invalid/non-approved application ID or batch no./sequence_id already exists.

**Authorization**
This API is authorized via API token. You can generate API token from the portal and use in authorization headers like:
```
Authorization: Token <API_TOKEN>
```

**Required Parameters**

- `application_id` - (string) Require application_id of an approved application. Click on "Copy to clipboard" option from applications dashboard page.

**Optional Parameters**

- `sequence_id`: (string) Batch no./sequence no. to uniquely identify current batch. Default: random unique string generated by system
- `hsn_code`: (string) HSN code of the product being registered. This will override the HSN code selected while submitting the product application. `hsn_code` must be a valid code part of the main category selected in product application.
- `item_key`: (string) Optional to parameter to make the product item unique if sequence_id is not unique. Using of the item key will generate URL like: `http://<domain>/product-details/<application_id>/<sequence_id>/<item_key>`

**Request Body**

This endpoint allows to register multiple batches against one application_id. The data being sent for each batch is dependent on the product. User can send any type of data apart from the optional parameters mentioned above. Optional parameters are reserved keywords for the API.

Example:
```
[
    {
        "Company Website": "https://www.test.in/",
        "Address of Mfg. Unit": "Vijayanagar Karnataka 583123",
        "Grade/Standard": "Good",
        "Dimensions": "22m",
        "Weight": "235kg",
        "Heat / Cast Number": "150",
        "hsn_code": "72191112",
        "sequence_id": "batch-no-1"
    }
]
```

**Response Body**
Sample response contains the original request body along the with state, msg and URL

- `state`: (string) Created/Existed/Error
- `msg`: (string) Present only in case of error
- `url`: (string) URL of the registered product batch

Example:
```
[
    {
       ...original request
        "state": "Existed",
        "url": "https://<domain>/product-details/<application_id>/<sequence_id>"
    }
]
```

**USAGE**

- Using cURL command:

```
curl --location --request POST 'https://mi-backend.qci.solutions/api/v1/products/<application_id>/' \
--header 'Authorization: Token <API_TOKEN>' \
--header 'Content-Type: application/json' \
--data-raw '[
    {
        "Company Website": "https://www.abcd.in/",
        "Address of Mfg. Unit": "Vijayanagar Karnataka 583123",
        "Grade/Standard": "Good",
        "Dimensions": "22m",
        "Weight": "235kg",
        "Heat / Cast Number": "150",
        "hsn_code": "72191112",
        "sequence_id": "batch-no-1"
    }
]'
```

- Using Python:

```
import requests
import json

url = "http://mi-backend.qci.solutions/api/v1/products/<application_id>/"

payload = json.dumps([
  {
    "Company Website": "https://www.abcd.in/",
    "Address of Mfg. Unit": "Vijayanagar Karnataka 583123",
    "Grade/Standard": "Good",
    "Dimensions": "22m",
    "Weight": "235kg",
    "Heat / Cast Number": "150",
    "hsn_code": "72191112",
    "sequence_id": "batch-no-1"
  }
])
headers = {
  'Authorization': 'Token <API_TOKEN>',
  'Content-Type': 'application/json',
  'Cookie': 'AWSALB=4pNHF6kOIzCudYUjfraSx1TtHDaiQ0qpszLyab9dAABl9h68ben20D+sGCGFw7OI4AgiexAkqeqSuQg8MROCXNRtZY3wq2Fgoz1d0MNvDHJqb5QQOeoe5oYtdU1n; AWSALBCORS=4pNHF6kOIzCudYUjfraSx1TtHDaiQ0qpszLyab9dAABl9h68ben20D+sGCGFw7OI4AgiexAkqeqSuQg8MROCXNRtZY3wq2Fgoz1d0MNvDHJqb5QQOeoe5oYtdU1n'
}

response = requests.request("POST", url, headers=headers, data=payload)

print(response.text)

```

- Using PHP - cURL

```
<?php

$curl = curl_init();

curl_setopt_array($curl, array(
  CURLOPT_URL => 'http://mi-backend.qci.solutions/api/v1/products/<application_id>/',
  CURLOPT_RETURNTRANSFER => true,
  CURLOPT_ENCODING => '',
  CURLOPT_MAXREDIRS => 10,
  CURLOPT_TIMEOUT => 0,
  CURLOPT_FOLLOWLOCATION => true,
  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
  CURLOPT_CUSTOMREQUEST => 'POST',
  CURLOPT_POSTFIELDS =>'[
    {
        "Company Website": "https://www.abcd.in/",
        "Address of Mfg. Unit": "Vijayanagar Karnataka 583123",
        "Grade/Standard": "Good",
        "Dimensions": "22m",
        "Weight": "235kg",
        "Heat / Cast Number": "150",
        "hsn_code": "72191112",
        "sequence_id": "batch-no-1"
    }
]',
  CURLOPT_HTTPHEADER => array(
    'Authorization: Token <API_TOKEN>,
    'Content-Type: application/json',
    'Cookie: AWSALB=4pNHF6kOIzCudYUjfraSx1TtHDaiQ0qpszLyab9dAABl9h68ben20D+sGCGFw7OI4AgiexAkqeqSuQg8MROCXNRtZY3wq2Fgoz1d0MNvDHJqb5QQOeoe5oYtdU1n; AWSALBCORS=4pNHF6kOIzCudYUjfraSx1TtHDaiQ0qpszLyab9dAABl9h68ben20D+sGCGFw7OI4AgiexAkqeqSuQg8MROCXNRtZY3wq2Fgoz1d0MNvDHJqb5QQOeoe5oYtdU1n'
  ),
));

$response = curl_exec($curl);

curl_close($curl);
echo $response;

```
